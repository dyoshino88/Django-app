{% extends "base.html" %}
{% block content %}
<h2>{{ topic.title }}</h2>

{% for text in texts %}
<div class="col-1 offset-1">
  {% if text.user.picture %}
    <img style="float:left;" width="50pc" height="50px" src="{{ text.user.picture.url }}">
  {% endif %}
</div>
<div class="col-5 offset-2">
  <p>ユーザーネーム: {{ text.user.username }}</p>
  <p>{{ text.text | linebreaks }}</p>
</div>
<div class="col-5 offset-1">
<hr>
</div>
{% endfor %}
{% if user.is_authenticated %}
<div class="col-5 offset-1">
  <form method="POST">
  {% csrf_token %}
  {{ post_text_form.as_p }}
  <input type = "button" value="保存" id="save_text">
  <input type = "submit" value="テキスト送信">
  </form>
</div>
{% endif %}
{% endblock %}
{% block javascript %}
<script>
$("#save_text").click(function(){
  var text = $("#id_text").val();
  $.ajax({
    url: "{% url 'board_app:save_text' %}",
    type: "GET",
    data: {text: text, topic_id: "{{ topic.id }}"},
    dataType: "json",
    success: function(json){
      if(json.message){
        alert(json.message);
      }
    }
  });
});
</script>
{% endblock %}